<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cuba ‚Äî Comunistando</title>
  <meta name="description" content="√öltimas not√≠cias de Cuba ‚Äî Comunistando." />
  <link rel="stylesheet" href="../../styles.css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-red-900 via-zinc-900 to-black text-zinc-100 font-sans">
  <header class="bg-gradient-to-r from-red-800 via-red-700 to-red-600 text-white shadow-xl">
    <div class="max-w-6xl mx-auto px-4 py-6">
      <div class="flex items-center justify-between">
        <a href="../../index.html" class="text-3xl md:text-4xl font-extrabold tracking-tight">üü• Comunistando</a>
        <span class="text-white/90 text-sm" id="today"></span>
      </div>
      <p class="text-white/90 max-w-3xl mt-2">Not√≠cias recentes de Cuba, em portugu√™s do Brasil, com fontes citadas.</p>
      <nav class="mt-4 text-sm flex flex-wrap gap-3 text-white/90">
        <a href="../china/">China</a>
        <a href="../russia/">R√∫ssia</a>
        <a href="../india-analises-sul-sul/">√çndia</a>
        <a href="../cuba/">Cuba</a>
        <a href="../vietna/">Vietn√£</a>
        <a href="../coreia-do-norte/">Coreia do Norte</a>
        <a href="../laos/">Laos</a>
        <a href="../venezuela/">Venezuela</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <h2 class="text-2xl font-extrabold mb-4">Cuba</h2>
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="news-list"></section>
  </main>

  <footer class="border-t border-zinc-800 bg-zinc-900">
    <div class="max-w-6xl mx-auto px-4 py-6 text-sm text-zinc-400">
      ¬© <span id="year"></span> Comunistando.
    </div>
  </footer>

  <script>
    const SLUG = 'cuba';
    const NAME = 'Cuba';
    const D = new Date();
    document.getElementById('today').textContent = new Intl.DateTimeFormat('pt-BR', { dateStyle: 'full' }).format(D);
    document.getElementById('year').textContent = D.getFullYear();

    function slugify(s=''){return s.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');}
    function escapeHtml(s=''){return s.replace(/[&<>"']/g,(c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}
    function formatDate(iso){try{return new Intl.DateTimeFormat('pt-BR',{dateStyle:'medium', timeStyle:'short'}).format(new Date(iso));}catch{return '';}}

    async function loadNews(){
      const res = await fetch('../../data/news.json', { cache: 'no-store' });
      const items = await res.json();
      const filtered = items.filter(n => slugify(n.country) === SLUG || n.country === NAME);
      renderNews(filtered);
    }

    function renderNews(items){
      const host = document.getElementById('news-list');
      host.innerHTML = '';
      items.forEach(n => {
        const url = n.permalink ? ('../..' + n.permalink) : n.sourceUrl;
        const card = document.createElement('article');
        card.className = 'bg-zinc-800 border border-zinc-700 shadow-lg rounded-2xl p-4 hover:border-red-600 transition-colors';
        card.innerHTML = `
          ${n.imageUrl ? `<a href="${url}"><img src="${n.imageUrl}" class="w-full h-40 object-cover rounded-xl mb-3 border border-zinc-700" onerror="this.remove()"></a>` : ``}
          <h3 class="text-lg font-bold mb-1"><a href="${url}" class="hover:underline">${escapeHtml(n.title)}</a></h3>
          <div class="text-xs text-zinc-400 mb-2"><time>${formatDate(n.publishedAt)}</time></div>
          <p class="text-zinc-300 text-sm mb-3">${escapeHtml(n.summary)}</p>
          <div class="flex items-center justify-between">
            <a href="${url}" class="text-red-400 hover:text-red-300 font-medium">Ler no Comunistando ‚Üí</a>
            <a href="${n.sourceUrl}" target="_blank" rel="noopener" class="text-zinc-400 hover:text-zinc-200 text-sm">Fonte: ${escapeHtml(n.sourceName)} ‚Üó</a>
          </div>
        `;
        host.appendChild(card);
      });
    }
    loadNews();
  </script>
</body>
</html>
